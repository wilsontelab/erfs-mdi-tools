---
pipeline:
    name: atac
    description: "prepare protamine ATAC-seq data for analysis in the interactive app"
    # version: v0.0.1
# suiteVersions:
#     suiteName: v0.0.0
actions: 
    _global:   
        environment: protamine-tools
        condaFamilies:
            - base
            - genomics
            - r-4.4
    collate:
        order: 1
        optionFamilies:
            - input
            - genome
            - spike-in
            - insert
            - bin
            - stage
            - score
        resources:
            required:
                total-ram: 8G
            recommended: 
                n-cpu: 4
                ram-per-cpu: 2G
        job-manager:
            recommended:
                time-limit: 2:00:00
        description: "collate read data across all samples into high resolution bins with various scores"
    tss:
        order: 2
        optionFamilies:
            - tss-input
            - genome
            - annotation
            - insert
            - stage
            - tss
        resources:
            required:
                total-ram: 8G
            recommended: 
                n-cpu: 4
                ram-per-cpu: 2G
        job-manager:
            recommended:
                time-limit: 2:00:00
        description: "map ATAC fragments around (in)active TSSs at base-level resolution"
    # segment:
    #     order: 3
    #     optionFamilies:
    #         - input
    #         - genome
    #         - spike-in
    #         - insert
    #         - bin
    #         - score
    #         - segment
    #     resources:
    #         required:
    #             total-ram: 8G
    #         recommended: 
    #             n-cpu: 4
    #             ram-per-cpu: 2G
    #     job-manager:
    #         recommended:
    #             time-limit: 2:00:00
    #     description: "segment meiotic ATAC-seq bins into histone and protamine inferred states"
package:
    collate: # the pipeline action after which a data package should assembled
        uploadType: protamine-atac # a signal to the Stage 2 framework regarding the package contents
        files:
            binCounts:
                type: rds
                file: $DATA_FILE_PREFIX.binCounts.rds
            insertSizes:
                type: rds
                file: $DATA_FILE_PREFIX.insertSizes.rds
            scores:
                type: rds
                file: $DATA_FILE_PREFIX.scores.rds
    tss:
        uploadType: protamine-atac-tss # a signal to the Stage 2 framework regarding the package contents
        files:
            tssFrags:
                type: rds
                file: $DATA_FILE_PREFIX.tssFrags.rds
            abInitio:
                type: rds
                file: $DATA_FILE_PREFIX.abInitio.rds
    # segment: # the pipeline action after which a data package should assembled
    #     uploadType: protamine-atac # a signal to the Stage 2 framework regarding the package contents
    #     extends:    collate
    #     files:
    #         segmentation:
    #             type: rds
    #             file: $DATA_FILE_PREFIX.segmentation.rds
container:
    supported: false
    registry:  ghcr.io  # domain name of your OCI-compatible, oras-accessible, container registry [ghcr.io]
    owner:     xxxxxxxx # the name of the owner, e.g., user or organization, at 'registry'
    installer: apt-get  # the installer program used by the container OS, typically apt-get or yum [apt-get]
